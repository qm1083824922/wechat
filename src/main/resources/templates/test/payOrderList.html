<!DOCTYPE html>
<html lang="zh-CN" xmlns:text-align="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>付款单</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div id="app" class="container-fluid">
    <div class="row-fluid">
        <ul id="myTab" class="nav nav-pills" role="tablist">
            <li class="active"><a href="#bulletin" role="tab">待处理</a></li>
<!--            <li><a href="#rule" role="tab" >已处理</a></li>-->
            <li><a href="#rule" role="tab" @click="resolved">已处理</a></li>
            <li><a href="#forum" role="tab">抄送我</a></li>
        </ul>
        <!-- 选项卡面板 -->
        <div id="myTabContent" class="tab-content">
            <div class="tab-pane fade in active" id="bulletin">
                <div v-for="(item,i) in items">
                    <h5>单据编号: {{item.poNo}}</h5>
                    <h5>单据类型: {{item.poTypeName}}</h5>
                    <h5>项目: {{item.projectName}}</h5>
                    <h5>金额: {{item.amount}} 元</h5>
                    <h5>审核状态: <span class="label label-info">{{item.stateName}}</span></h5>
                    <h5>申请时间： {{item.proposerAt}}</h5>
                    <h5>申请人: {{item.proposer}}</h5>
                    <p class="btn btn-primary btn-sm" @click="detail(item.id,item.poId)">查看详情</p>
                    <hr>
                </div>
            </div>
            <div class="tab-pane fade" id="rule">
                <div v-for="(deal,i) in dealOrderList">
                    <h5>单据编号: {{deal.poNo}}</h5>
                    <h5>单据类型: {{deal.poTypeName}}</h5>
                    <h5>项目: {{deal.projectName}}</h5>
                    <h5>金额: {{deal.amount}} 元</h5>
                    <h5>审核状态: <span class="label label-success">{{deal.stateName}}</span></h5>
                    <h5>申请时间： {{deal.proposerDate}}</h5>
                    <h5>申请人: {{deal.proposer}}</h5>
                    <hr>
                </div>
            </div>
            <div class="tab-pane fade" id="forum">论坛内容面板</div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
<script src="https://cdn.bootcss.com/vue/2.6.10/vue.min.js"></script>
<script src="https://cdn.bootcss.com/axios/0.19.0/axios.js"></script>
<script src="https://cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.js"></script>

<script>
    $(function () {
        $("#myTab a").click(function (e) {
            e.preventDefault();
            $(this).tab("show");
        });
        $("#myTab").on("show.bs.tab", function (e) {
            $(e.target).css('outline', '1px solid black');
        }).on("hide.bs.tab", function (e) {
            $(e.target).css('outline', 'none');
        })
    });

    const vm = new Vue({
        el: '#app',
        data: {
            items: [],
            dealOrderList: [],
            domain: 'http://localhost:9090/'
            // domain: 'http://devwx.asters.cn/'
            // domain: ' http://xcra5j.natappfree.cc/'
        },
        mounted() {
            this.list();
        },
        methods: {
            list() {
                const url = this.domain + "pay/waitingAuditOrder";
                axios.get(url)
                    .then((response) => {
                        console.log(response);
                        this.items = response.data.data.items;
                    })
                    .catch((error) => {
                        console.log(error);
                    })
            },
            detail(id, payId, poType) {
                $.cookie('payId', payId);
                $.cookie('auditId', id);
                //跳转单据详情页面
                window.location.href = this.domain + "wechat/portal/payDetail";
            },
            resolved() {
                const url = this.domain + "pay/resolvedOrderList";
                axios.get(url)
                    .then((response)=> {
                        console.log(response);
                        vm.dealOrderList = response.data.data;
                    })
                    .catch((error)=> {
                        console.log(error);
                    });
            }
        }
    })

</script>
</body>
</html>
